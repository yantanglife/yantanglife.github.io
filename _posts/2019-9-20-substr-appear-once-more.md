---
layout: post
title:  "All SubString Appear Once More"
date:   2019-9-20 12:00:00
categories: Algorithm
tags: LeetCode Cpp BitOperation SubString
permalink: /archivers/SubString10
comments: true
---
## æè¿°
æ‰€æœ‰ DNA ç”±ä¸€ç³»åˆ—ç¼©å†™ä¸º Aï¼ŒCï¼ŒG å’Œ T çš„æ ¸è‹·é…¸ç»„æˆï¼Œä¾‹å¦‚ï¼š`ACGAATTCCG`.

åœ¨ç ”ç©¶ DNA æ—¶ï¼Œè¯†åˆ« DNA ä¸­çš„é‡å¤åºåˆ—æœ‰æ—¶ä¼šå¯¹ç ”ç©¶éå¸¸æœ‰å¸®åŠ©.

ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾ DNA åˆ†å­ä¸­**æ‰€æœ‰å‡ºç°è¶…å¤šä¸€æ¬¡çš„10ä¸ªå­—æ¯é•¿çš„åºåˆ—ï¼ˆå­ä¸²ï¼‰**.
<!--more-->
## ç¤ºä¾‹

è¾“å…¥: `s = "AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT"`

è¾“å‡º: `["AAAAACCCCC", "CCCCCAAAAA"]`

## åˆ†æ

**æŸ¥æ‰¾å­ä¸²ï¼Œè¿™ä¸ªå­ä¸²é•¿åº¦ä¸º10ï¼Œä¸”åœ¨åŸå­—ç¬¦ä¸²ä¸­å‡ºç°è¶…è¿‡ä¸€æ¬¡.**

## ä»£ç 

ä»¥ä¸‹ä¸ºè¯„è®ºåŒºä»£ç ï¼Œä½¿ç”¨çš„**ä½è¿ç®—**ï¼Œå¾ˆå¼ºğŸ‘

*åšä¸€ä¸ªç®€è¦è®°å½•.*

***
4 ä¸ªå­—ç¬¦éœ€è¦ 2 ä¸ª bit è¡¨ç¤ºï¼Œä¸€ä¸ªé•¿åº¦ä¸º 10 çš„å­ä¸²åˆ™éœ€è¦ 20 ä¸ªbit. ä¾‹å¦‚
> A: 00, B: 01, C: 10, D: 11

20 ä¸ª bit èƒ½è¡¨ç¤ºçš„æ•°å€¼åœ¨ `0 ~ (1 << 20 - 1)` ä¹‹é—´.

åˆ™å®šä¹‰ä¸€ä¸ª `(1 << 20)` é•¿åº¦çš„ bitset. ä¸å¦¨è®°ä¸º`S`. 
å³é€šè¿‡ `S` å°±å¯ä»¥è¡¨ç¤ºå‡ºæ‰€æœ‰é•¿åº¦ä¸º 10 çš„å­ä¸²äº†. 

ä¾‹å¦‚ï¼Œå¯¹äºå­ä¸²`AAAAAAAABB`ï¼Œ20 ä½çš„ bit æ˜¾ç„¶ä¸º`0000 0000 0000 0000 0101`.
å€¼ä¸º 5.
å³å¯¹åº” `S` ä½ 5 ä½ä¸º **1**.

ä¾æ­¤ï¼Œæ¯æ¬¡é¡ºä½è¯»ä¸€ä¸ªé•¿åº¦ä¸º 10 çš„å­ä¸². 
è‹¥ `S1` å¯¹åº”**ä½çš„å€¼ä¸º 0** (`s1.test(val) == False`)ï¼Œå³è¯¥å­ä¸²æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œ
ç½®è¯¥ä½å€¼ä¸º 1 (`s1.set(val)`)ï¼›
å¦åˆ™ï¼Œæ˜¯ç¬¬äºŒæ¬¡å‡ºç°ï¼Œè®°å½•è¯¥å­ä¸².

å¦å¤–ï¼Œå¯ä»¥å†ç”¨ä¸€ä¸ª bitset å˜é‡ `S2` æ¥è®°å½•å·²å‡ºç°ä¸¤æ¬¡çš„å­ä¸²ï¼ŒåŠ å¿«éå†é€Ÿåº¦.



```cpp
class Solution {
public:
    vector<string> findRepeatedDnaSequences(string s) {
        // å¯¹åº”äºŒè¿›åˆ¶00, 01, 10, 11. é‚£ä¹ˆ10ä¸ªç»„åˆåªè¦20ä½å°±å¤Ÿäº†.
        unordered_map<char, int> m{ {'A', 0}, {'C', 1}, {'G', 2}, {'T', 3} };
        vector<string> res;
        bitset<1 << 20> s1, s2; //é‚£ä¹ˆæ‰€æœ‰ç»„åˆçš„å€¼å°†åœ¨0åˆ°(1 << 20 - 1)ä¹‹é—´
        int val = 0, mask = (1 << 20) - 1; //maskç­‰äºäºŒè¿›åˆ¶çš„20ä¸ª1
        // ç±»ä¼¼ä¸æ»‘åŠ¨çª—å£å…ˆæŠŠå‰10ä¸ªå­—æ¯ç»„åˆ
        for (int i = 0; i < 10; ++i) val = (val << 2) | m[s[i]];
        s1.set(val); //ç½®ä½
        for (int i = 10; i < s.size(); ++i) {
            val = ((val << 2) & mask) | m[s[i]]; //å»æ‰å·¦ç§»çš„ä¸€ä¸ªå­—ç¬¦å†åŠ ä¸Šä¸€ä¸ªæ–°å­—ç¬¦
            if (s2.test(val)) continue; //å‡ºç°è¿‡ä¸¤æ¬¡è·³è¿‡
            if (s1.test(val)) {
                res.push_back(s.substr(i - 9, 10));
                s2.set(val);
            }
            else s1.set(val);
        }
        return res;
    }
};
```

## å‚è€ƒ
[LeetCode-187. é‡å¤çš„DNAåºåˆ—](https://leetcode-cn.com/problems/repeated-dna-sequences/)